<!DOCTYPE html>
<html>
<head>
    <title>Auto Order Test</title>
</head>
<body>
    <h1>Placing order automatically...</h1>
    <div id="status"></div>
    
    <script>
        const status = document.getElementById('status');
        
        async function placeOrder() {
            try {
                status.innerHTML = '<p>üõí Step 1: Placing order via API...</p>';
                
                const orderData = {
                    theaterId: "68f8837a541316c6ad54b79f",
                    customerName: "+919944400587",
                    customerInfo: {
                        name: "Auto Test Customer",
                        phone: "+919944400587"
                    },
                    tableNumber: "Seat-A1",
                    items: [
                        {
                            productId: "68fc97311263296dbc0ac4c9",
                            quantity: 5
                        }
                    ],
                    paymentMethod: "card"
                };

                const response = await fetch('http://localhost:5000/api/orders/theater', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(orderData)
                });

                const result = await response.json();

                if (response.ok) {
                    status.innerHTML = `
                        <div style="background: #d4edda; padding: 20px; border-radius: 8px; margin: 20px 0;">
                            <h2 style="color: #155724;">‚úÖ ORDER PLACED SUCCESSFULLY!</h2>
                            <p><strong>Order Number:</strong> ${result.order.orderNumber}</p>
                            <p><strong>Customer:</strong> ${result.order.customerInfo.phone}</p>
                            <p><strong>Item:</strong> ${result.order.items[0].name} x ${result.order.items[0].quantity}</p>
                            <p><strong>Total:</strong> ‚Çπ${result.order.pricing.total}</p>
                            <p><strong>Payment:</strong> ${result.order.payment.method.toUpperCase()}</p>
                            <p><strong>Status:</strong> ${result.order.status.toUpperCase()}</p>
                        </div>
                        <p style="background: #fff3cd; padding: 15px; border-radius: 8px;">
                            <strong>üéØ Next Step:</strong> Opening Online POS page in 3 seconds...
                        </p>
                    `;

                    // Wait 3 seconds then open POS page
                    setTimeout(() => {
                        window.open('http://localhost:3001/online-pos/68f8837a541316c6ad54b79f', '_blank');
                        status.innerHTML += '<p style="color: green; font-weight: bold;">‚úÖ POS Page opened! Scroll down to see "Customer Orders (QR Code)" section</p>';
                    }, 3000);
                } else {
                    throw new Error(result.error || 'Order failed');
                }

            } catch (error) {
                status.innerHTML = `
                    <div style="background: #f8d7da; padding: 20px; border-radius: 8px;">
                        <h2 style="color: #721c24;">‚ùå ERROR</h2>
                        <p>${error.message}</p>
                    </div>
                `;
            }
        }

        // Auto-run on page load
        placeOrder();
    </script>
</body>
</html>
